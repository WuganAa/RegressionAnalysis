---
title: "Autumn7 秋第7周上机内容"
author: "ChenXG 陈栩淦 3160104014"
date: "12/17/2018"
output: html_document
---


```{r}
Sys.setlocale("LC_ALL", locale = "en_US.UTF-8")
setwd("~/Project/RegressionAnalysis")
```



## 秋第7周上机内容

为了研究水的耗氧量与周围环境的关系，在实验室条件下，对连续放置220天的水进行不断的测试，一共做了20次观测。选取如下变量进行观察：水的日耗氧量取对数（$y$），生物耗氧量（$x_1$），总的耗氧量（$x_2$），固定物质含量（$x_3$），挥发性固定物质含量（$x_4$），化学物质耗氧量（$x_5$）。其中$x_1$到$x_5$的单位都是$mg/L$，$y$的单位是$mg/min$。数据如下表所示。试给出回归分析，并进行回归诊断，包括模型的诊断和数据的诊断。


```{r}
# loading data
x1 <- c(1125, 920, 835, 1000, 1150, 990, 840, 650, 640, 583,
        570, 570, 510, 555, 460, 275, 510, 165, 244, 79)
x2 <- c(232, 268, 271, 237, 192, 202, 184, 200, 180, 165,
        151, 171, 243, 147, 286, 198, 196, 210, 327, 334)
x3 <- c(7160, 8804, 8108, 6370, 6441, 5154, 5896, 5336, 5041, 5012,
        4825, 4391, 4320, 3790, 3969, 3558, 4361, 3301, 2964, 2777)
x4 <- c(85.9, 86.5, 85.2, 83.8, 82.1, 79.2, 81.2, 80.6, 78.4, 79.3,
        78.7, 78.0, 72.3, 74.9, 74.4, 72.5, 57.7, 71.8, 72.5, 71.9)
x5 <- c(8905, 7388, 5348, 8056, 6960, 5690, 6932, 5400, 3177, 4461,
        3901, 5002, 4665, 4642, 4840, 4479, 4200, 3410, 3360, 2599)
y <- c(1.5563, 0.8976, 0.7482, 0.716, 0.313, 0.3617, 0.1139, 0.1139, -0.2218, -0.1549,
       0.0000, 0.0000, -0.0969, -0.2218, -0.3979, -0.1540, -0.2218, -0.3919, -0.5229, -0.0458)

data <- data.frame(y, x1, x2, x3, x4, x5)
```



## 回归分析

```{r}
# 回归分析
lm.sol <- lm(y~., data = data)
summary(lm.sol)
lm.sol$coefficients
```



我们可以得到回归方程：
\begin{align}
y = & -1.384069\times10^{-5}\times x_1 + 1.322039 \times10^{-3}\times x_2 + 1.285999 \times10^{-4} \times x_3 \\
& + 7.866999\times10^{-3}\times x_4 + 1.418110 \times10^{-4}\times x_5 -2.157027.
\end{align}

## 回归诊断

```{r}
y.fit <- predict(lm.sol)
e.hat <- residuals(lm.sol)
e.std <- rstandard(lm.sol)
```

### 模型的诊断

```{r}
plot(e.hat~y.fit)
```


```{r}
plot(e.std~y.fit)
```

```{r}
plot(lm.sol, which = 1)
```

通过残差图，我们可以看到这个残差图不呈现任何明显的规则性。

```{r}
plot(lm.sol, which = 2)
```

通过残差图和QQ图，我们接受线性假设、方差齐性假设、不相关性假设和正态性假设。



### 数据的诊断

```{r}
plot(e.std~y.fit)
text(y.fit, e.std, type = "1:20")
```

```{r}
plot(lm.sol, which = 1)
```

```{r}
e.std
```

我们可以看到，第1号样本点为异常点。



```{r}
influence.measures(lm.sol)
```


我们可以看到，第1、2、9、17、19、20号的样本点是强影响点。


* 结论：第1号样本点为异常点，第1、2、3、9、17、20号的样本点是强影响点。由残差图和QQ图，我们接受线性假设、方差齐性假设、不相关性假设和正态性假设。




